{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "jq -r '.tool_input.command // empty' | { read cmd; if echo \"$cmd\" | grep -qiE 'DROP TABLE|DROP SCHEMA|TRUNCATE|DELETE FROM.*[^W][^H][^E][^R][^E]'; then echo '[proagent-data] WARNING: Destructive SQL operation detected (DROP/TRUNCATE/DELETE). Confirm this is intentional and provide a rollback plan before proceeding.'; fi; }",
            "timeout": 10
          },
          {
            "type": "command",
            "command": "jq -r '.tool_input.command // empty' | { read cmd; if echo \"$cmd\" | grep -qE 'dbt run|dbt build|dbt seed|alembic upgrade|alembic downgrade'; then echo '[proagent-data] Database operation detected. Verify: (1) schema naming conventions (stg_/int_/dim_/fct_), (2) migration has rollback, (3) quality tests are included.'; fi; }",
            "timeout": 10
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "jq -r '.tool_input.command // empty' | { read cmd; if echo \"$cmd\" | grep -qE 'dbt run|dbt build|psql|snowsql|bq query'; then echo '[proagent-data] Query/model execution completed. Check for long-running operations and verify data quality with dbt test or quality checks.'; fi; }",
            "timeout": 10
          }
        ]
      },
      {
        "matcher": "Write",
        "hooks": [
          {
            "type": "command",
            "command": "jq -r '.tool_input.file_path // empty' | { read fp; if echo \"$fp\" | grep -qE '\\.sql$'; then echo '[proagent-data] SQL file written. Verify: (1) no SELECT *, (2) explicit JOIN syntax, (3) parameterized queries for user input, (4) CTEs for readability.'; fi; }",
            "timeout": 10
          }
        ]
      }
    ]
  }
}
